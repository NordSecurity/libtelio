# NAT lab

NAT lab is an environment where libtelio is tested.
We are working on making it locally runnable for everyone outside of
Nord Security organization, but currently it is only possible to run
them in the CI.

## Prerequisites

- [just](https://just.systems/)
- [uv](https://docs.astral.sh/uv/)

## Formatting

Python code is formatted using https://github.com/psf/black, https://github.com/PyCQA/isort and https://github.com/PyCQA/autoflake.
Unformatted code will automatically be declined by the CI.
```
just black && just isort && just autoflake
```

## Linter and typecheck

Python code is checked using https://github.com/python/mypy and https://github.com/pylint-dev/pylint.
Any faulty code will automatically be declined by the CI.
```
just mypy && just pylint
```

## Dependency lock / upgrade
All dependencies and transitive dependencies should be locked to prevent breaking things. Also has to be updated from time to time, to keep things fresh.

#### How to lock
```
$ uv lock
```

#### How to upgrade

Edit the `pyproject.toml` and after that run `uv sync`. See [here](https://docs.astral.sh/uv/concepts/projects/dependencies/) for detailed description of dependency management with uv.

## Network topology
For the network topology of the containers please refer to [network.md](network.md)

The diagram is generated by parsing the `docker-compose.yml` file.
To update the diagram run 
```bash
python3 utils/generate_network_diagram.py docker-compose.yml network.md
```

