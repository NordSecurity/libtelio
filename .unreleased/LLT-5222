Add downgrade logic using link detection